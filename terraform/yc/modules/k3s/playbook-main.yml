- name: prepare VM
  hosts: all
  become: true
  tasks:
    - name: install software
      apt:
        pkg:
          - mc
          - git
          - vim
          - htop
        state: latest
        update_cache: true
    - name: Copy .deb package to the remote server
      copy:
        src: "{{ package_src }}"
        dest: "{{ package_dest }}"
        mode: "0644"

    - name: Install the .deb package
      apt:
        deb: "{{ package_dest }}"
        state: present

- import_playbook: ./playbook-hostnames.yml
- import_playbook: ./playbook-k3s.yml
- import_playbook: ./playbook-argocd.yml

- name: Final Play
  hosts: localhost
  tasks:
    - name: Display completion message
      debug:
        msg: "All playbooks completed"
